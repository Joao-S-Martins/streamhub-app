<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="dist/streamhub-sdk.min.css">
        <!--link rel="stylesheet" type="text/css" href="dist/streamhub-ui.min.css"-->
        <link rel="stylesheet" type="text/css" href="dist/streamhub-share.min.css">
        <style>
        #view {
            /*width:300px;*/
        }
        </style>
    </head>
    <body>
        <div id="view"></div>

        <!--script src="lib/cajon/cajon.js" type="text/javascript"></script>
        <script src="requirejs.conf.js" type="text/javascript"></script>
        <script>
            requirejs({
                baseUrl: ""
            });
        </script-->

        <script type="text/javascript" src="auth-delegates.v0.4.4-beta.min.js"></script>
        <script type="text/javascript" src="dist/streamhub-sdk.min.js"></script>
        <!--script type="text/javascript" src="dist/streamhub-ui.min.js"></script>
        <script type="text/javascript" src="dist/streamhub-share.min.js"></script-->
        <script type="text/javascript" src="dist/streamhub-permalink.min.js"></script>
        <script type="text/javascript" src="dist/streamhub-wall.min.js"></script>

        <script>
        // var MediaWall = Livefyre.require('streamhub-wall');
        //     $ = Livefyre.require('jquery');

        HubPermalink.require([
            'streamhub-permalink',
            'streamhub-permalink/enums'
        ],function (Permalink, permalinkEnums) {
            var collection,
                collection2,
                view,
                config = {
                    assetServer: '/dev',
                    authDelegateVersion: 'v0.4.4-beta',
                    cdn: 'http://cdn.livefyre.com'
                },
                Collection = Livefyre.require('streamhub-sdk/collection'),
                MediaWall = Livefyre.require('streamhub-wall'),
                qaConfig = {
                    "collectionMeta":"eyJ0eXAiOiJqd3QiLCJhbGciOiJIUzI1NiJ9.eyJ0aXRsZSI6ImJsYWggZmFhYWhhaGFhIiwidXJsIjoiaHR0cDpcL1wvb3Jhbmdlc2FyZWdyZWF0LmNvbVwvcWFfZXh0X3YzXC8_cD0yMTAiLCJ0YWdzIjoiIiwiY2hlY2tzdW0iOiIxZjc3YzJmNTI4MGZlNDNjMjZkNWU3Y2JjYTc3OWZjOSIsImFydGljbGVJZCI6MjEwfQ.MvfXiV8hEgXd2iGu1o3Dc3XTQEOtaL361AeF25skZLM",
                    "checksum":"1f77c2f5280fe43c26d5e7cbca779fc9",
                    "siteId":"290596",
                    "articleId":210,
                    "disableThirdPartyAnalytics":true,
                    "betaBanner":true,
                    "el":"comments",
                    environment: 'qa.livefyre.com',
                    network: "livefyre.com"
                },
                qaCollection;

            (function initCollection() {
                collection = new Collection({
                    network: 'livefyre.com',
                    environment: 't402.livefyre.com',
                    id: 10772933
                });
                collection2 = new Collection({
                    environment: 't402.livefyre.com',
                    network: "labs-t402.fyre.co",
                    siteId: "303827",
                    articleId: "xbox-0"
                });
                qaCollection = new Collection(qaConfig);

                // var sharer = new Sharer(config);//For the assetServer
                // sharer.delegate(true);//HACK

                view = new MediaWall({//View({
                    initial: 3,
                    showMore: 3,
                    el: document.getElementById('view')
                });
                var archive = qaCollection.createArchive();
                archive.read();
                archive.pipe(view.more);
            })();

            //index.html?meaning=less#lf-content=t402.livefyre.com:10772933:26482715&not=something
            var pl = Permalink,
                key = permalinkEnums.KEYS.CONTENT;

            //Set a default handler for permalinked content
            // pl.default(key, function(content) {
            //     console.log('Default handling for permalink content');
            // })

            //Try to get content from the permalink module
            window.content = pl.get(key);
            if (!window.content) {
                //Attach listener incase content arrives
                pl.on(key, function () {
                    var content = pl.get(key);
                    // pl.preventDefault(key);//Uncomment in to prevent the default handler
                });
            }
        });
        </script>
    </body>
</html>
